{% extends "global/Page.html" %}
{% load otree static %}

{% block title %}
{% endblock %}

{% block scripts %}

<script>
    // Gender popout function
    function genderPopout() {
        var genderOther = document.getElementById('genderOther');
        var otherDiv = document.getElementById('otherDiv');
        var timestampField = document.getElementById('time_gender_popout');
        
        if (genderOther.checked) {
            otherDiv.style.display = "block";
            timestampField.value = getCurrentTimestamp();
        } else {
            otherDiv.style.display = "none";
        }
    }

    // Travel popout function
    function travelPopout() {
        var travelYes = document.getElementById('travelYes');
        var divYes = document.getElementById('divYes');
        var timestampField = document.getElementById('time_travel_popout');
        
        if (travelYes.checked) {
            divYes.style.display = "block";
            timestampField.value = getCurrentTimestamp();
        } else {
            divYes.style.display = "none";
        }
    }

    // Set initial timestamp when page loads
    document.addEventListener('DOMContentLoaded', function() {
        document.getElementById('time_page_load').value = getCurrentTimestamp();
    });
</script>

{% endblock %}

{% block content %}
<br>
<h2> General Questions </h2>
<hr>
<p>First, we'd like to ask some general questions.</p>
<hr>

<!-- persist-raw script input -->
<script src="{% static 'persist-raw.js' %}"></script>

<!-- Age question -->
{{ formfield "age_question" }}

<!-- Hidden field to record gender popout timestamp -->
<input id="time_gender_popout" type="hidden" name="time_gender_popout" />
{{ formfield_errors 'time_gender_popout' }}

<!-- Gender question -->
<br>
<div>
    <p><b>What is your gender?</b></p>
    {% for gender_value, gender_label in available_genders.items() %}
        <input type="radio" name="gender_question" value="{{ gender_value }}" /> {{ gender_label }}
        <br>
    {% endfor %}
</div>


<!-- Gender "Other" popout -->
<div id="otherDiv" style="display: none">
    {{ formfield 'gender_popout' }}
</div>

<!-- Hidden field to record travel popout timestamp -->
<input id="time_travel_popout" type="hidden" name="time_travel_popout" />
{{ formfield_errors 'time_travel_popout' }}

<!-- Travel question -->
<br>
<div>
    <b>Have you ever travelled before?</b>
    <div><input id="travelYes" type="radio" name="has_travelled" value=True class="persist" onclick="travelPopout()" /> Yes</div>
    <div><input id="travelNo" type="radio" name="has_travelled" value=False class="persist" onclick="travelPopout()" /> No</div>
</div>

<!-- Travel destination popout -->
<div id="divYes" style="display: none">
    {{ formfield 'travel_destination_popout' }}
</div>

<hr>
<button class="otree-btn-next btn btn-primary next-button otree-next-button">
    Next
</button>

{% endblock %}